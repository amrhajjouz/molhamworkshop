<page-header title="قائمة الإتفاقيات" pretitle="القسم المالي">
    <a href="{{ $r('agreements.add') }}" class="btn btn-primary">
        <i class="fe fe-plus"></i>&nbsp; إتفاقية جديدة
    </a>
</page-header>

<datatable datalist="agreements">
    <table>
        <thead>
            <tr>
                <th class="text-center">#</th>
                <th class="text-center">لعنوان</th>
                <th class="text-center"> المبلغ المطلوب</th>
                <th class="text-center">العملة</th>
                <th class="text-center">نسبة المصاريف الإدارية</th>
                <th class="text-center">المبلغ المجموع</th>
                <th class="text-center">عدد سندات الصرف</th>
                <th class="text-center">الحالة</th>
                <th class="text-center">بداية التنفيذ</th>
                <th class="text-center">نهاية التنفيذ</th>
                <th class="text-center">خيارات</th>
            </tr>
        </thead>

        <tbody>
            <tr ng-repeat="d in agreements.data">
                <td class="align-middle text-center">{{ d.id }}</td>
                <td class="align-middle text-center">{{ d.title }}</td>
                <td class="align-middle text-center">{{ d.amount }}</td>
                <td class="align-middle text-center">{{ d.currency }}</td>
                <td class="align-middle text-center">{{ d.admin_costs_percentage }}%</td>
                <td class="align-middle text-center">{{ d.vouchers_total_amount }}</td>
                <td class="align-middle text-center">{{ d.vouchers_number }}</td>
                <td class="align-middle text-center">

                    <div class="badge" ng-class="{'badge-soft-warning': d.status == 'pending' ,'badge-soft-danger': d.status == 'canceled' ,'badge-soft-success': d.status == 'completed' }">
                        {{ statusToText(d.status)}}
                    </div>
                </td>
                <td class="align-middle text-center datatable-date">{{ d.starting_date }}</td>
                <td class="align-middle text-center datatable-date">{{ d.ending_date }}</td>
                <td class="align-middle text-center h2">
                    <dropdown ng-hide="d.status == 'completed'">
                        <dropdown-item href="{{ $r('agreements.assign.vouchers', {id: d.id}) }}" ng-hide="d.status!='pending'"><i class="fa fa-handshake-o "></i> تعديل السندات </dropdown-item>
                        <dropdown-item href="{{ $r('agreements.edit', {id: d.id}) }}" ng-hide="d.status!='pending'"><i class="fe fe-edit-2"></i> تعديل الإتفاقية</dropdown-item>
                        <dropdown-item href="javascript:;" ng-click="updateAgreementState('canceled',d)" ng-hide="d.status!='pending'" ><i class="fa fa-times"></i> إلغاء الإتفاقية</dropdown-item>
                        <dropdown-item href="javascript:;" ng-click="updateAgreementState('completed',d)" ng-hide="d.status!='pending'"><i class="fa fa-check-square-o"></i> إكمال الإتفاقية</dropdown-item>
                    </dropdown>
                </td>
            </tr>
        </tbody>
    </table>
</datatable>
